import T from"./Icon.c06bed71.js";import{f as n,m as i,w as $,r as C,v as S,u as f,p as a,F as g,y as b,K as u,C as k,k as N,t as p,o as s,h as w,c as I,x as D,J as j,T as U}from"./entry.1193afd1.js";import"./config.d1d7188f.js";var P=function d(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var l,r,h;if(Array.isArray(e)){if(l=e.length,l!=t.length)return!1;for(r=l;r--!==0;)if(!d(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(h=Object.keys(e),l=h.length,l!==Object.keys(t).length)return!1;for(r=l;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,h[r]))return!1;for(r=l;r--!==0;){var c=h[r];if(!d(e[c],t[c]))return!1}return!0}return e!==e&&t!==t};const A="__googleMapsScriptId";var _;(function(d){d[d.INITIALIZED=0]="INITIALIZED",d[d.LOADING=1]="LOADING",d[d.SUCCESS=2]="SUCCESS",d[d.FAILURE=3]="FAILURE"})(_||(_={}));class y{constructor({apiKey:e,authReferrerPolicy:t,channel:l,client:r,id:h=A,language:c,libraries:v=[],mapIds:o,nonce:m,region:E,retries:K=3,url:O="https://maps.googleapis.com/maps/api/js",version:R}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=l,this.client=r,this.id=h||A,this.language=c,this.libraries=v,this.mapIds=o,this.nonce=m,this.region=E,this.retries=K,this.url=O,this.version=R,y.instance){if(!P(this.options,y.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(y.instance.options)}`);return y.instance}y.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?_.FAILURE:this.done?_.SUCCESS:this.loading?_.LOADING:_.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+=`?callback=${this.CALLBACK}`,this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(l=>{l?t(l.error):e(window.google)})})}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){if(document.getElementById(this.id)){this.callback();return}const e=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=e,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const t=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=e,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}const M={class:"bg-body-tertiary border rounded p-2 mb-2 shadow"},x={class:"form-floating"},F=["placeholder"],B={class:"form-floating"},L=["placeholder"],G={class:"d-grid mt-2"},V={class:"btn btn-primary",type:"submit"},q=["src"],J=["onClick"],Z={class:"d-flex rutas-mibus bg-body-tertiary border rounded rounded p-2"},z={class:"fw-bold m-0"},W={class:"d-flex align-items-center flex-wrap"},H={key:0,class:"travel_icon",src:"https://maps.gstatic.com/mapfiles/transit/iw2/6/walk.png",width:"20",height:"20"},Q={key:1,class:"d-flex align-items-center flex-wrap"},X=["src"],Y={key:0},ee={class:"my-2 small"},te={class:"text-end"},ie={class:"text-primary fw-bold m-0"},se={class:"small m-0"},re={key:0},oe={class:"h-100 me-2"},ne={class:"w-100"},le={class:"fw-bold"},ae={class:"small"},de={key:0},ce={class:"my-2 d-flex align-items-center"},he={class:"border-start ps-2"},ue={class:"fw-bold"},me={class:"small"},pe={class:"m-0"},fe={class:"m-0"},ge={key:1},ye={data(){return{apiKey:"",form:{origin:"",destination:""},directions:{geocoded_waypoints:[],routes:[]},selected:null}},methods:{async getDirections(){k.isOnline()?(this.apiKey=this.apiKey?this.apiKey:await N.googleKey(),this.form.origin=this.form.origin.trim(),this.form.destination=this.form.destination.trim(),new y({apiKey:this.apiKey,version:"weekly"}).load().then(e=>{const t=new e.maps.DirectionsService,l={origin:this.form.origin,destination:this.form.destination,travelMode:"TRANSIT",unitSystem:e.maps.UnitSystem.METRIC,region:"pa",provideRouteAlternatives:!0,language:p("lang_code")};t.route(l,(r,h)=>{h===e.maps.DirectionsStatus.OK&&(this.directions=r)})}).catch(e=>{k.showToast({message:e.message})})):k.showToast({message:p("error_conexion")})},selectRoute(d){this.selected=this.selected!==d?d:null}}},we=Object.assign(ye,{__name:"direcciones",setup(d){return(e,t)=>{const l=T;return s(),n("section",null,[i("div",M,[i("form",{onSubmit:t[2]||(t[2]=$(r=>e.getDirections(),["prevent"]))},[i("div",x,[C(i("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.origin=r),class:"form-control rounded-top",placeholder:("t"in e?e.t:f(p))("location"),required:""},null,8,F),[[S,e.form.origin]]),i("label",null,a(("t"in e?e.t:f(p))("location")),1)]),i("div",B,[C(i("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.destination=r),class:"form-control rounded-top-0",placeholder:("t"in e?e.t:f(p))("destino"),required:""},null,8,L),[[S,e.form.destination]]),i("label",null,a(("t"in e?e.t:f(p))("destino")),1)]),i("div",G,[i("button",V,a(("t"in e?e.t:f(p))("buscar")),1)])],32)]),e.directions.routes.length?(s(),n(g,{key:0},[i("iframe",{class:"rounded border",src:`https://www.google.com/maps/embed/v1/directions?origin=place_id:${e.directions.geocoded_waypoints[0].place_id}&destination=place_id:${e.directions.geocoded_waypoints[1].place_id}&mode=transit&units=metric&language=${("t"in e?e.t:f(p))("lang_code")}&region=pa&key=${e.apiKey}`,width:"100%",height:"400px",allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"},null,8,q),(s(!0),n(g,null,b(e.directions.routes,(r,h)=>(s(),n("div",{key:h,class:"mb-2",role:"button",onClick:c=>e.selectRoute(h)},[i("div",Z,[(s(!0),n(g,null,b(r.legs,(c,v)=>(s(),n("div",{key:v,class:"flex-grow-1"},[i("h5",z,a(c.departure_time.text)+" - "+a(c.arrival_time.text),1),i("div",W,[(s(!0),n(g,null,b(c.steps,(o,m)=>(s(),n("div",{key:m,class:"d-flex align-items-center flex-wrap"},[m<c.steps.length-1?(s(),n(g,{key:0},[o.travel_mode==="WALKING"?(s(),n("img",H)):u("",!0),o.travel_mode==="TRANSIT"?(s(),n("div",Q,[i("img",{class:"travel_icon",src:o.transit.line.vehicle.icon,width:"20",height:"20"},null,8,X),o.transit?(s(),n("div",Y,[i("div",ee,[i("span",{class:"px-1 rounded shadow-sm",style:w({backgroundColor:o.transit.line.color,color:o.transit.line.text_color})},a(o.transit.line.short_name),5)])])):u("",!0)])):u("",!0),m<c.steps.length-2?(s(),I(l,{key:2,name:"material-symbols:chevron-right"})):u("",!0)],64)):u("",!0)]))),128))])]))),128)),i("div",te,[i("h4",ie,a(r.legs[0].duration.text),1),i("p",se,"("+a(r.legs[0].distance.text)+")",1)])]),D(U,{name:"t",mode:"out-in"},{default:j(()=>[h===e.selected?(s(),n("div",re,[(s(!0),n(g,null,b(r.legs,(c,v)=>(s(),n("div",{key:v,class:"bg-body-tertiary rounded border shadow p-3 mt-1"},[(s(!0),n(g,null,b(c.steps,(o,m)=>(s(),n("div",{key:m,class:"d-flex position-relative"},[i("div",oe,[m<c.steps.length-1?(s(),n(g,{key:0},[o.travel_mode==="WALKING"?(s(),n("div",{key:0,class:"me-2 rounded position-absolute bg-primary",style:w({width:"10px",left:"3px",bottom:0,top:"1.5rem",height:"calc(100% - 1.5rem)"})},null,4)):u("",!0),o.travel_mode==="TRANSIT"?(s(),n("div",{key:1,class:"me-2 rounded position-absolute",style:w({backgroundColor:o.transit.line.color||"var(--border)",width:"10px",left:"3px",bottom:0,top:"1.5rem",height:"calc(100% - 1.5rem)"})},null,4)):u("",!0)],64)):u("",!0),m<c.steps.length-1?(s(),I(l,{key:1,name:"ic:outline-circle"})):(s(),I(l,{key:2,name:"ic:baseline-radio-button-checked"}))]),i("div",ne,[i("div",null,[i("div",le,a(o.instructions),1),i("div",ae,a(o.duration.text)+" ("+a(o.distance.text)+")",1)]),o.transit?(s(),n("div",de,[i("div",ce,[i("div",{class:"p-1 rounded shadow-sm fw-bold me-2",style:w({backgroundColor:o.transit.line.color,color:o.transit.line.text_color})},a(o.transit.line.short_name),5),i("div",he,[i("div",ue,a(o.transit.line.name),1),i("div",me,[i("p",pe,a(("t"in e?e.t:f(p))("departure"))+": "+a(o.transit.departure_stop.name),1),i("p",fe,a(("t"in e?e.t:f(p))("arrival"))+": "+a(o.transit.arrival_stop.name),1)])])])])):u("",!0),m<c.steps.length-1?(s(),n("hr",ge)):u("",!0)])]))),128))]))),128))])):u("",!0)]),_:2},1024)],8,J))),128))],64)):u("",!0)])}}});export{we as default};
