import v from"./Icon.10e85218.js";import{_ as b}from"./ProgressDialog.9571c6cb.js";import{f as d,m as e,p as n,u as o,F as g,y as k,w as P,q as u,K as h,x as c,A as i,D as V,s as A,k as C,L as w,C as _,t as r,l as I,j,o as l,M as p,N}from"./entry.7031e3e9.js";import"./config.e2ba8976.js";const T={class:"bg-body-tertiary border rounded p-2 mb-2 shadow"},q={class:"text-primary-emphasis m-0"},B={class:"m-2"},D=["value"],M={class:"bg-body-tertiary border rounded p-2 mb-2 shadow"},$={class:"text-primary-emphasis m-0"},F={class:"m-2"},G=["value"],K={class:"bg-body-tertiary border rounded p-2 mb-2 shadow"},L={class:"text-primary-emphasis m-0"},O={class:"m-2"},S={key:0,class:"bg-body-tertiary border rounded p-2 mb-2 shadow"},z={class:"text-primary-emphasis m-0"},E={class:"m-2"},R={class:"mb-3 position-relative"},U=["placeholder","value"],H={class:"invalid-tooltip"},J={class:"mb-3"},Q=["placeholder","value"],W={class:"mb-3"},X=["placeholder","value"],Y={class:"d-grid"},Z=["value"],x={key:1,class:"text-center mt-3"},ss={class:"small m-0"},es={data(){return{readonly:{nombre:i().user.nombre,email:i().user.email,tarjetas:[]},form:{current_password:"",new_password:"",password_check:"",error:!1}}},computed:{isPasswordValid(){return this.form.new_password.length>=3&&this.form.current_password!==this.form.new_password&&this.form.current_password.length>0},isPasswordCheckValid(){return this.isPasswordValid&&this.form.new_password===this.form.password_check}},async mounted(){this.readonly.tarjetas=await V.getTarjetas()},methods:{async updatePass(){if(this.isPasswordValid&&this.isPasswordCheckValid){A("progress-dialog");const{error:m,error_key:s}=await C.userPassUpdate({current_password:await w(this.form.current_password),new_password:await w(this.form.new_password),email:i().user.email,token:i().user.token});m?(s==="pass_error"&&(this.form.error=!0,this.$refs.current.focus()),await _.showToast(r(s),"long")):(await _.showToast(r("pass_updated"),"long"),this.form={current_password:"",new_password:"",password_check:""})}await I(.5),j("progress-dialog")}}},ns=Object.assign(es,{__name:"perfil",setup(m){return(s,a)=>{const f=v,y=b;return l(),d("section",null,[e("div",T,[e("h4",q,[e("b",null,n(("t"in s?s.t:o(r))("nombre")),1)]),e("div",B,[e("input",{value:("readonly"in s?s.readonly:o(p)).nombre,class:"form-control",type:"text",readonly:""},null,8,D)])]),e("div",M,[e("h4",$,[e("b",null,n(("t"in s?s.t:o(r))("correo")),1)]),e("div",F,[e("input",{value:("readonly"in s?s.readonly:o(p)).email,class:"form-control",type:"text",readonly:""},null,8,G)])]),e("div",K,[e("h4",L,[e("b",null,n(("t"in s?s.t:o(r))("tarjetas_vinculadas")),1)]),e("div",O,[(l(!0),d(g,null,k(("readonly"in s?s.readonly:o(p)).tarjetas,t=>(l(),d("p",{key:t.numero,class:"m-0"},[c(f,{name:"material-symbols:credit-card-outline"}),N(" "+n(t.numero)+" ("+n(t.nombre)+")",1)]))),128))])]),("Auth"in s?s.Auth:o(i))().isGuest?h("",!0):(l(),d("div",S,[e("h4",z,[e("b",null,n(("t"in s?s.t:o(r))("password")),1)]),e("div",E,[e("form",{novalidate:"",onSubmit:a[4]||(a[4]=P(t=>s.updatePass(),["prevent"]))},[e("div",R,[e("input",{ref:"current",class:u(["form-control",{"is-invalid":s.form.error}]),type:"password",autocomplete:"password",placeholder:("t"in s?s.t:o(r))("current_pass"),value:s.form.current_password,required:"",onInput:a[0]||(a[0]=t=>s.form.current_password=t.target.value),onKeyup:a[1]||(a[1]=t=>s.form.error=!1)},null,42,U),e("div",H,n(("t"in s?s.t:o(r))("pass_error")),1)]),e("div",J,[e("input",{class:u(["form-control",{"is-valid":s.isPasswordValid}]),type:"password",autocomplete:"new-password",placeholder:("t"in s?s.t:o(r))("new_pass"),value:s.form.new_password,required:"",onInput:a[2]||(a[2]=t=>s.form.new_password=t.target.value)},null,42,Q)]),e("div",W,[e("input",{class:u(["form-control",{"is-valid":s.isPasswordCheckValid}]),type:"password",autocomplete:"off",placeholder:("t"in s?s.t:o(r))("password_check"),value:s.form.password_check,required:"",onInput:a[3]||(a[3]=t=>s.form.password_check=t.target.value)},null,42,X)]),e("div",Y,[e("input",{class:"btn btn-primary",type:"submit",role:"button",value:("t"in s?s.t:o(r))("change_pass")},null,8,Z)])],32)])])),("Auth"in s?s.Auth:o(i))().isGuest?(l(),d("div",x,[e("p",ss,[e("small",null,n(("t"in s?s.t:o(r))("nota")),1)])])):h("",!0),c(y,{message:("t"in s?s.t:o(r))("updating_pass")},null,8,["message"])])}}});export{ns as default};
